{
  "timestamp": "2025-07-25T03:45:00.192Z",
  "environment": "production",
  "testType": "security-penetration-test",
  "project": {
    "name": "Mamapace",
    "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
  },
  "summary": {
    "totalTests": 9,
    "passedTests": 7,
    "failedTests": 1,
    "warningTests": 1,
    "criticalIssues": 1,
    "highIssues": 1,
    "securityScore": 45
  },
  "detailedResults": {
    "suiteName": "セキュリティペネトレーションテスト",
    "totalTests": 9,
    "passedTests": 7,
    "failedTests": 1,
    "warningTests": 1,
    "criticalIssues": 1,
    "highIssues": 1,
    "overallSecurityScore": 45,
    "testResults": [
      {
        "testName": "ブルートフォース攻撃耐性テスト",
        "category": "authentication",
        "severity": "high",
        "status": "warning",
        "duration": 2225,
        "description": "ブルートフォース攻撃で10回成功しました",
        "details": {
          "totalAttempts": 10,
          "successfulAttacks": 10
        },
        "recommendations": [
          "レート制限の実装",
          "一時的なアカウントロック機能の追加"
        ]
      },
      {
        "testName": "認証バイパス試行テスト",
        "category": "authentication",
        "severity": "critical",
        "status": "fail",
        "duration": 253,
        "description": "認証バイパスが可能です",
        "details": {
          "attemptResults": [
            {
              "param": "",
              "description": "空文字列",
              "success": true,
              "data": [
                {
                  "user_id": "e723e342-9e1e-4bb3-a0f9-36640737220b",
                  "access_token": "access_token_e723e342-9e1e-4bb3-a0f9-36640737220b",
                  "refresh_token": "refresh_token_e723e342-9e1e-4bb3-a0f9-36640737220b",
                  "profile_data": {
                    "id": "e723e342-9e1e-4bb3-a0f9-36640737220b",
                    "bio": null,
                    "nickname": "",
                    "avatar_url": null,
                    "created_at": "2025-07-25T02:54:12.999303+00:00",
                    "updated_at": "2025-07-25T03:44:58.904295+00:00",
                    "is_anonymous": false,
                    "privacy_settings": {
                      "posts_visible": true,
                      "profile_visible": true
                    },
                    "maternal_book_number": ""
                  }
                }
              ]
            },
            {
              "param": "null",
              "description": "null文字列",
              "success": true,
              "data": [
                {
                  "user_id": "6c1a25a5-fc9c-42ec-a17d-5aa486e541a1",
                  "access_token": "access_token_6c1a25a5-fc9c-42ec-a17d-5aa486e541a1",
                  "refresh_token": "refresh_token_6c1a25a5-fc9c-42ec-a17d-5aa486e541a1",
                  "profile_data": {
                    "id": "6c1a25a5-fc9c-42ec-a17d-5aa486e541a1",
                    "bio": null,
                    "nickname": "null",
                    "avatar_url": null,
                    "created_at": "2025-07-25T03:44:58.948202+00:00",
                    "updated_at": "2025-07-25T03:44:58.948202+00:00",
                    "is_anonymous": false,
                    "privacy_settings": {
                      "posts_visible": true,
                      "profile_visible": true
                    },
                    "maternal_book_number": "null"
                  }
                }
              ]
            },
            {
              "param": "admin",
              "description": "管理者系キーワード",
              "success": true,
              "data": [
                {
                  "user_id": "9e57c82b-e835-446e-9689-f9594dcbf314",
                  "access_token": "access_token_9e57c82b-e835-446e-9689-f9594dcbf314",
                  "refresh_token": "refresh_token_9e57c82b-e835-446e-9689-f9594dcbf314",
                  "profile_data": {
                    "id": "9e57c82b-e835-446e-9689-f9594dcbf314",
                    "bio": null,
                    "nickname": "admin",
                    "avatar_url": null,
                    "created_at": "2025-07-25T03:44:58.997346+00:00",
                    "updated_at": "2025-07-25T03:44:58.997346+00:00",
                    "is_anonymous": false,
                    "privacy_settings": {
                      "posts_visible": true,
                      "profile_visible": true
                    },
                    "maternal_book_number": "admin"
                  }
                }
              ]
            },
            {
              "param": "0",
              "description": "ゼロ値",
              "success": true,
              "data": [
                {
                  "user_id": "ef765a68-1cd1-4437-9026-b94d6b2cb851",
                  "access_token": "access_token_ef765a68-1cd1-4437-9026-b94d6b2cb851",
                  "refresh_token": "refresh_token_ef765a68-1cd1-4437-9026-b94d6b2cb851",
                  "profile_data": {
                    "id": "ef765a68-1cd1-4437-9026-b94d6b2cb851",
                    "bio": null,
                    "nickname": "0",
                    "avatar_url": null,
                    "created_at": "2025-07-25T03:44:59.046831+00:00",
                    "updated_at": "2025-07-25T03:44:59.046831+00:00",
                    "is_anonymous": false,
                    "privacy_settings": {
                      "posts_visible": true,
                      "profile_visible": true
                    },
                    "maternal_book_number": "0"
                  }
                }
              ]
            },
            {
              "param": "true",
              "description": "ブール値",
              "success": true,
              "data": [
                {
                  "user_id": "d2b7232e-37f8-48e5-88e4-d50663e93245",
                  "access_token": "access_token_d2b7232e-37f8-48e5-88e4-d50663e93245",
                  "refresh_token": "refresh_token_d2b7232e-37f8-48e5-88e4-d50663e93245",
                  "profile_data": {
                    "id": "d2b7232e-37f8-48e5-88e4-d50663e93245",
                    "bio": null,
                    "nickname": "true",
                    "avatar_url": null,
                    "created_at": "2025-07-25T03:44:59.103996+00:00",
                    "updated_at": "2025-07-25T03:44:59.103996+00:00",
                    "is_anonymous": false,
                    "privacy_settings": {
                      "posts_visible": true,
                      "profile_visible": true
                    },
                    "maternal_book_number": "true"
                  }
                }
              ]
            }
          ]
        },
        "recommendations": [
          "認証パラメータの厳密な検証",
          "入力値のサニタイゼーション強化"
        ]
      },
      {
        "testName": "セッション管理セキュリティテスト",
        "category": "authentication",
        "severity": "low",
        "status": "pass",
        "duration": 51,
        "description": "セッション管理が適切に実装されています",
        "details": {
          "tokenFormat": "valid",
          "hasAccessToken": true,
          "hasRefreshToken": true,
          "userIdIncluded": true
        }
      },
      {
        "testName": "権限昇格攻撃テスト",
        "category": "authorization",
        "severity": "low",
        "status": "pass",
        "duration": 349,
        "description": "RLSポリシーが適切に権限昇格攻撃を防いでいます",
        "details": {
          "accessResults": [
            {
              "table": "users",
              "action": "select",
              "description": "ユーザー情報への不正アクセス",
              "unauthorized": false,
              "error": "RLS制限正常"
            },
            {
              "table": "posts",
              "action": "insert",
              "description": "投稿の不正作成",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"SECURITY_TEST_1753415099397\""
            },
            {
              "table": "likes",
              "action": "delete",
              "description": "いいねの不正削除",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"non_existent_id\""
            },
            {
              "table": "comments",
              "action": "update",
              "description": "コメントの不正更新",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"non_existent_id\""
            }
          ]
        }
      },
      {
        "testName": "IDOR攻撃テスト",
        "category": "authorization",
        "severity": "low",
        "status": "pass",
        "duration": 192,
        "description": "IDOR攻撃に対して適切に保護されています",
        "details": {
          "idorResults": [
            {
              "id": "00000000-0000-0000-0000-000000000001",
              "table": "users",
              "vulnerable": false,
              "error": "アクセス拒否"
            },
            {
              "id": "99999999-9999-9999-9999-999999999999",
              "table": "posts",
              "vulnerable": false,
              "error": "アクセス拒否"
            },
            {
              "id": "admin",
              "table": "users",
              "vulnerable": false,
              "error": "invalid input syntax for type uuid: \"admin\""
            },
            {
              "id": "1",
              "table": "posts",
              "vulnerable": false,
              "error": "invalid input syntax for type uuid: \"1\""
            }
          ]
        }
      },
      {
        "testName": "データ漏洩防止テスト",
        "category": "data_access",
        "severity": "low",
        "status": "pass",
        "duration": 136,
        "description": "データ漏洩攻撃に対して適切に保護されています",
        "details": {
          "leakageResults": [
            {
              "query": "users",
              "fields": "*",
              "description": "全ユーザー情報の取得試行",
              "leaked": false,
              "error": "アクセス拒否"
            },
            {
              "query": "users",
              "fields": "email,maternal_book_number",
              "description": "機密情報の取得試行",
              "leaked": false,
              "error": "column users.email does not exist"
            },
            {
              "query": "posts",
              "fields": "*",
              "description": "全投稿情報の取得試行",
              "leaked": false,
              "error": "アクセス拒否"
            }
          ]
        }
      },
      {
        "testName": "SQLインジェクション攻撃テスト",
        "category": "injection",
        "severity": "low",
        "status": "pass",
        "duration": 283,
        "description": "SQLインジェクション攻撃に対して適切に保護されています",
        "details": {
          "injectionResults": [
            {
              "payload": "'; DROP TABLE users; --",
              "vulnerable": false,
              "error": "safe"
            },
            {
              "payload": "' UNION SELECT * FROM users --",
              "vulnerable": false,
              "error": "safe"
            },
            {
              "payload": "'; INSERT INTO users VALUES ('hacked') --",
              "vulnerable": false,
              "error": "safe"
            },
            {
              "payload": "1' OR '1'='1",
              "vulnerable": false,
              "error": "safe"
            },
            {
              "payload": "admin'; --",
              "vulnerable": false,
              "error": "safe"
            }
          ]
        }
      },
      {
        "testName": "HTTPS/TLS設定テスト",
        "category": "network",
        "severity": "low",
        "status": "pass",
        "duration": 0,
        "description": "HTTPS通信が適切に設定されています",
        "details": {
          "protocol": "HTTPS",
          "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
        }
      },
      {
        "testName": "APIエンドポイントセキュリティテスト",
        "category": "network",
        "severity": "low",
        "status": "pass",
        "duration": 41,
        "description": "APIエンドポイントが適切にセキュリティ設定されています",
        "details": {
          "errorHandling": "appropriate"
        }
      }
    ]
  },
  "recommendations": [
    "1個のクリティカルなセキュリティ問題を即座に修正してください。",
    "1個の高リスクセキュリティ問題の修正を推奨します。",
    "認証システム: レート制限とアカウントロック機能の実装を検討してください。",
    "定期的なセキュリティテスト（月1回）の実行を推奨します。",
    "セキュリティ監視とログ分析システムの導入を検討してください。"
  ]
}