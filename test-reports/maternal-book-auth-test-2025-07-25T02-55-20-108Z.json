{
  "timestamp": "2025-07-25T02:55:20.109Z",
  "environment": "production",
  "testType": "maternal-book-auth",
  "project": {
    "name": "Mamapace",
    "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
  },
  "summary": {
    "total": 12,
    "passed": 10,
    "failed": 2,
    "skipped": 0,
    "successRate": 83,
    "totalDuration": 681
  },
  "tests": [
    {
      "testName": "カスタム認証関数存在確認",
      "status": "pass",
      "duration": 146,
      "message": "カスタム認証関数が存在し、呼び出し可能です"
    },
    {
      "testName": "認証関数レスポンス構造確認",
      "status": "pass",
      "duration": 48,
      "message": "認証関数のレスポンス構造が正常です"
    },
    {
      "testName": "新規ユーザー作成",
      "status": "pass",
      "duration": 62,
      "message": "新規ユーザー作成成功: ID 17e14838-3289-4217-be50-026deb8ec029"
    },
    {
      "testName": "auth.usersテーブル挿入確認",
      "status": "fail",
      "duration": 95,
      "message": "ユーザーテーブル確認エラー: JSON object requested, multiple (or no) rows returned",
      "details": {}
    },
    {
      "testName": "重複登録時の動作確認",
      "status": "pass",
      "duration": 40,
      "message": "既存ユーザーのニックネーム更新が正常に動作しています"
    },
    {
      "testName": "既存ユーザー認証",
      "status": "pass",
      "duration": 48,
      "message": "既存ユーザー認証成功: テストママ"
    },
    {
      "testName": "認証トークン生成確認",
      "status": "pass",
      "duration": 41,
      "message": "認証トークン生成成功: access_token, refresh_token確認済み"
    },
    {
      "testName": "母子手帳番号一意性確認",
      "status": "pass",
      "duration": 50,
      "message": "母子手帳番号の一意性が保たれています"
    },
    {
      "testName": "データベース制約確認",
      "status": "fail",
      "duration": 66,
      "message": "制約確認エラー: JSON object requested, multiple (or no) rows returned",
      "details": {}
    },
    {
      "testName": "メールアドレス形式確認",
      "status": "pass",
      "duration": 0,
      "message": "メールアドレス形式正常: MB001234567@maternal.book"
    },
    {
      "testName": "不正パラメータエラーハンドリング",
      "status": "pass",
      "duration": 43,
      "message": "注意: 空パラメータでもデータが返されました（設計確認要）"
    },
    {
      "testName": "長大パラメータ処理確認",
      "status": "pass",
      "duration": 42,
      "message": "適切に長さ制限エラー: value too long for type character varying(255)"
    }
  ],
  "customAuthSystem": {
    "functionName": "auth_with_maternal_book",
    "emailPattern": "@maternal.book",
    "supports": [
      "new_user_creation",
      "existing_user_auth",
      "nickname_update"
    ]
  },
  "recommendations": [
    "2個のテストが失敗しました。以下の問題を修正してください：",
    "- auth.usersテーブル挿入確認: ユーザーテーブル確認エラー: JSON object requested, multiple (or no) rows returned",
    "- データベース制約確認: 制約確認エラー: JSON object requested, multiple (or no) rows returned",
    "セキュリティ関連のテストで問題が発見されました。データ保護の強化を検討してください。"
  ]
}