{
  "timestamp": "2025-07-25T04:05:15.030Z",
  "environment": "production",
  "testType": "xss-csrf-security-test",
  "project": {
    "name": "Mamapace",
    "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
  },
  "summary": {
    "totalTests": 8,
    "passedTests": 8,
    "failedTests": 0,
    "warningTests": 0,
    "criticalIssues": 0,
    "highIssues": 0,
    "protectionScore": 100
  },
  "testResults": [
    {
      "testName": "基本XSSペイロードテスト",
      "category": "xss",
      "severity": "low",
      "status": "pass",
      "duration": 499,
      "description": "XSS攻撃に対して適切に保護されています",
      "response": [
        {
          "payload": "<script>alert(\"XSS\")</script>",
          "reflected": false,
          "sanitized": true
        },
        {
          "payload": "<img src=\"x\" onerror=\"alert('XSS')\">",
          "reflected": false,
          "sanitized": true
        },
        {
          "payload": "<svg onload=\"alert('XSS')\">",
          "reflected": false,
          "sanitized": true
        },
        {
          "payload": "\"><script>alert(\"XSS\")</script>",
          "reflected": false,
          "sanitized": true
        },
        {
          "payload": "javascript:alert(\"XSS\")",
          "reflected": false,
          "sanitized": true
        }
      ]
    },
    {
      "testName": "DOM-Based XSSテスト",
      "category": "xss",
      "severity": "low",
      "status": "pass",
      "duration": 194,
      "description": "DOM-Based XSS攻撃に対して適切に保護されています",
      "response": [
        {
          "payload": "#<script>alert(\"DOM-XSS\")</script>",
          "vulnerable": false,
          "safe": true
        },
        {
          "payload": "javascript:alert(\"DOM-XSS\")",
          "vulnerable": false,
          "safe": true
        },
        {
          "payload": "data:text/html,<script>alert(\"DOM-XSS\")</script>",
          "vulnerable": false,
          "safe": true
        },
        {
          "payload": "\"><img src=x onerror=alert(\"DOM-XSS\")>",
          "vulnerable": false,
          "safe": true
        }
      ]
    },
    {
      "testName": "Stored XSSテスト",
      "category": "xss",
      "severity": "low",
      "status": "pass",
      "duration": 58,
      "description": "Stored XSSペイロードの保存が適切に防がれています",
      "payload": "<script>alert(\"Stored-XSS-1753416314000\")</script>"
    },
    {
      "testName": "CSRF Token検証テスト",
      "category": "csrf",
      "severity": "low",
      "status": "pass",
      "duration": 131,
      "description": "CSRF攻撃が適切に防がれています",
      "response": {
        "normalRequest": false,
        "csrfRequest": false
      }
    },
    {
      "testName": "Origin/Referer検証テスト",
      "category": "csrf",
      "severity": "low",
      "status": "pass",
      "duration": 64,
      "description": "モバイルアプリのため、Origin/Referer検証は適用されません",
      "response": {
        "note": "React Native環境ではOrigin/Refererヘッダーは異なる扱い",
        "apiKeyProtection": true,
        "rlsProtection": true
      }
    },
    {
      "testName": "HTMLタグインジェクションテスト",
      "category": "injection",
      "severity": "low",
      "status": "pass",
      "duration": 284,
      "description": "HTMLタグインジェクション攻撃に対して適切に保護されています",
      "response": [
        {
          "payload": "<iframe src=\"javascript:alert('Injection')\"></iframe>",
          "injected": false,
          "filtered": true
        },
        {
          "payload": "<object data=\"javascript:alert('Injection')\"></object>",
          "injected": false,
          "filtered": true
        },
        {
          "payload": "<embed src=\"javascript:alert('Injection')\">",
          "injected": false,
          "filtered": true
        },
        {
          "payload": "<form action=\"javascript:alert('Injection')\">",
          "injected": false,
          "filtered": true
        },
        {
          "payload": "<meta http-equiv=\"refresh\" content=\"0;url=javascript:alert('Injection')\">",
          "injected": false,
          "filtered": true
        }
      ]
    },
    {
      "testName": "イベントハンドラインジェクションテスト",
      "category": "injection",
      "severity": "low",
      "status": "pass",
      "duration": 256,
      "description": "イベントハンドラインジェクション攻撃に対して適切に保護されています",
      "response": [
        {
          "payload": "onmouseover=\"alert('Event Handler')\"",
          "eventHandlerFound": false,
          "sanitized": true
        },
        {
          "payload": "onclick=\"alert('Event Handler')\"",
          "eventHandlerFound": false,
          "sanitized": true
        },
        {
          "payload": "onerror=\"alert('Event Handler')\"",
          "eventHandlerFound": false,
          "sanitized": true
        },
        {
          "payload": "onload=\"alert('Event Handler')\"",
          "eventHandlerFound": false,
          "sanitized": true
        },
        {
          "payload": "onfocus=\"alert('Event Handler')\"",
          "eventHandlerFound": false,
          "sanitized": true
        }
      ]
    },
    {
      "testName": "特殊文字サニタイゼーションテスト",
      "category": "validation",
      "severity": "low",
      "status": "pass",
      "duration": 230,
      "description": "特殊文字が適切にサニタイズされています",
      "response": [
        {
          "input": "<>&\"'`",
          "sanitized": true,
          "safe": true
        },
        {
          "input": "\\x3cscript\\x3e",
          "sanitized": true,
          "safe": true
        },
        {
          "input": "%3Cscript%3E",
          "sanitized": true,
          "safe": true
        },
        {
          "input": "&lt;script&gt;",
          "sanitized": true,
          "safe": true
        },
        {
          "input": "&#60;script&#62;",
          "sanitized": true,
          "safe": true
        }
      ]
    }
  ],
  "recommendations": [
    "XSS・CSRF対策は高いセキュリティレベルを達成しています。",
    "Content Security Policy (CSP)の実装を検討してください。",
    "定期的なXSS・CSRF脆弱性診断の実施を推奨します。",
    "開発者向けセキュアコーディング研修の実施を検討してください。"
  ]
}