{
  "timestamp": "2025-07-25T04:05:22.928Z",
  "environment": "production",
  "testType": "security-penetration-test",
  "project": {
    "name": "Mamapace",
    "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
  },
  "summary": {
    "totalTests": 9,
    "passedTests": 8,
    "failedTests": 0,
    "warningTests": 1,
    "criticalIssues": 0,
    "highIssues": 0,
    "securityScore": 95
  },
  "detailedResults": {
    "suiteName": "セキュリティペネトレーションテスト",
    "totalTests": 9,
    "passedTests": 8,
    "failedTests": 0,
    "warningTests": 1,
    "criticalIssues": 0,
    "highIssues": 0,
    "overallSecurityScore": 95,
    "testResults": [
      {
        "testName": "ブルートフォース攻撃耐性テスト",
        "category": "authentication",
        "severity": "low",
        "status": "pass",
        "duration": 1804,
        "description": "ブルートフォース攻撃に対して適切に保護されています",
        "details": {
          "totalAttempts": 10,
          "successfulAttacks": 0
        }
      },
      {
        "testName": "認証バイパス試行テスト",
        "category": "authentication",
        "severity": "low",
        "status": "pass",
        "duration": 347,
        "description": "認証バイパス攻撃に対して適切に保護されています",
        "details": {
          "attemptResults": [
            {
              "param": "",
              "description": "空文字列",
              "success": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "param": "null",
              "description": "null文字列",
              "success": false,
              "error": "Authentication system error"
            },
            {
              "param": "admin",
              "description": "管理者系キーワード",
              "success": false,
              "error": "Authentication system error"
            },
            {
              "param": "0",
              "description": "ゼロ値",
              "success": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "param": "true",
              "description": "ブール値",
              "success": false,
              "error": "Authentication system error"
            }
          ]
        }
      },
      {
        "testName": "セッション管理セキュリティテスト",
        "category": "authentication",
        "severity": "medium",
        "status": "warning",
        "duration": 66,
        "description": "セッション管理テストのベース認証が失敗しました",
        "details": {
          "error": "Authentication system error"
        }
      },
      {
        "testName": "権限昇格攻撃テスト",
        "category": "authorization",
        "severity": "low",
        "status": "pass",
        "duration": 216,
        "description": "RLSポリシーが適切に権限昇格攻撃を防いでいます",
        "details": {
          "accessResults": [
            {
              "table": "users",
              "action": "select",
              "description": "ユーザー情報への不正アクセス",
              "unauthorized": false,
              "error": "RLS制限正常"
            },
            {
              "table": "posts",
              "action": "insert",
              "description": "投稿の不正作成",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"SECURITY_TEST_1753416322051\""
            },
            {
              "table": "likes",
              "action": "delete",
              "description": "いいねの不正削除",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"non_existent_id\""
            },
            {
              "table": "comments",
              "action": "update",
              "description": "コメントの不正更新",
              "unauthorized": false,
              "error": "invalid input syntax for type uuid: \"non_existent_id\""
            }
          ]
        }
      },
      {
        "testName": "IDOR攻撃テスト",
        "category": "authorization",
        "severity": "low",
        "status": "pass",
        "duration": 209,
        "description": "IDOR攻撃に対して適切に保護されています",
        "details": {
          "idorResults": [
            {
              "id": "00000000-0000-0000-0000-000000000001",
              "table": "users",
              "vulnerable": false,
              "error": "アクセス拒否"
            },
            {
              "id": "99999999-9999-9999-9999-999999999999",
              "table": "posts",
              "vulnerable": false,
              "error": "アクセス拒否"
            },
            {
              "id": "admin",
              "table": "users",
              "vulnerable": false,
              "error": "invalid input syntax for type uuid: \"admin\""
            },
            {
              "id": "1",
              "table": "posts",
              "vulnerable": false,
              "error": "invalid input syntax for type uuid: \"1\""
            }
          ]
        }
      },
      {
        "testName": "データ漏洩防止テスト",
        "category": "data_access",
        "severity": "low",
        "status": "pass",
        "duration": 174,
        "description": "データ漏洩攻撃に対して適切に保護されています",
        "details": {
          "leakageResults": [
            {
              "query": "users",
              "fields": "*",
              "description": "全ユーザー情報の取得試行",
              "leaked": false,
              "error": "アクセス拒否"
            },
            {
              "query": "users",
              "fields": "email,maternal_book_number",
              "description": "機密情報の取得試行",
              "leaked": false,
              "error": "column users.email does not exist"
            },
            {
              "query": "posts",
              "fields": "*",
              "description": "全投稿情報の取得試行",
              "leaked": false,
              "error": "アクセス拒否"
            }
          ]
        }
      },
      {
        "testName": "SQLインジェクション攻撃テスト",
        "category": "injection",
        "severity": "low",
        "status": "pass",
        "duration": 274,
        "description": "SQLインジェクション攻撃に対して適切に保護されています",
        "details": {
          "injectionResults": [
            {
              "payload": "'; DROP TABLE users; --",
              "vulnerable": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "payload": "' UNION SELECT * FROM users --",
              "vulnerable": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "payload": "'; INSERT INTO users VALUES ('hacked') --",
              "vulnerable": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "payload": "1' OR '1'='1",
              "vulnerable": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            },
            {
              "payload": "admin'; --",
              "vulnerable": false,
              "error": "unrecognized exception condition \"authentication_failure\""
            }
          ]
        }
      },
      {
        "testName": "HTTPS/TLS設定テスト",
        "category": "network",
        "severity": "low",
        "status": "pass",
        "duration": 0,
        "description": "HTTPS通信が適切に設定されています",
        "details": {
          "protocol": "HTTPS",
          "url": "https://zfmqxdkqpeyvsuqyzuvy.supabase.co"
        }
      },
      {
        "testName": "APIエンドポイントセキュリティテスト",
        "category": "network",
        "severity": "low",
        "status": "pass",
        "duration": 44,
        "description": "APIエンドポイントが適切にセキュリティ設定されています",
        "details": {
          "errorHandling": "appropriate"
        }
      }
    ]
  },
  "recommendations": [
    "優秀なセキュリティ実装です。現在の設定で本番環境運用を推奨します。",
    "定期的なセキュリティテスト（月1回）の実行を推奨します。",
    "セキュリティ監視とログ分析システムの導入を検討してください。"
  ]
}